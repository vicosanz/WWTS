'------------------------------------------------------------------------------
' <auto-generated>
'     Este código fue generado por una herramienta.
'     Versión del motor en tiempo de ejecución:2.0.50727.3082
'
'     Los cambios en este archivo podrían causar un comportamiento incorrecto y se perderán si
'     se vuelve a generar el código.
' </auto-generated>
'------------------------------------------------------------------------------

Option Strict Off
Option Explicit On

Imports Infoware.Datos
Imports WWTS.General.Reglas
Imports Infoware.Reportes


#Region "CompatibilidadComponente"
Public Class Componente

  Const _Procedimiento As String = "proc_Componente"

#Region "Datos"

  Private mParameTipoComponente As WWTSParametroDet = Nothing
  'Parametrodet
  Public Overridable Overloads Property ParameTipoComponente() As WWTSParametroDet
    Get
      If mParameTipoComponente Is Nothing AndAlso Parame_TipoComponente > 0 Then
        mParameTipoComponente = New WWTSParametroDet(OperadorDatos, Parame_TipoComponente, Pardet_TipoComponente)
      End If
      Return Me.mParameTipoComponente
    End Get
    Set(ByVal value As WWTSParametroDet)
      Me.mParameTipoComponente = value
      Parame_TipoComponente = value.Parame_Codigo
      Pardet_TipoComponente = value.Pardet_Secuencia
    End Set
  End Property

  Private mModeloString As String
  Public Property ModeloString() As String
    Get
      Return ParameTipoComponente.Pardet_Descripcion
    End Get
    Set(ByVal value As String)

    End Set
  End Property

#End Region

#Region "New"

  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _EsNuevo As Boolean)
    MyBase.New()
    OperadorDatos = _OperadorDatos
    EsNuevo = _EsNuevo
  End Sub

  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _EsNuevo As Boolean, ByVal Item_Codigo As Integer)
    MyBase.New()
    OperadorDatos = _OperadorDatos
    EsNuevo = _EsNuevo
    Me.Item_Codigo = Item_Codigo
    Me.Recargar()
  End Sub

#End Region

  Public Overridable Sub MapearDataRowaObjeto(ByVal Fila As DataRow)
    Item_Codigo = CType(Fila("Item_Codigo"), Integer)
    Parame_TipoComponente = CType(Fila("Parame_TipoComponente"), Integer)
    Pardet_TipoComponente = CType(Fila("Pardet_TipoComponente"), Integer)
  End Sub

  Public Overridable Function Recargar() As Boolean
    Dim Result As System.Data.DataTable = New System.Data.DataTable
    Dim bReturn As Boolean = True
    OperadorDatos.AgregarParametro("@accion", "C")
    OperadorDatos.AgregarParametro("@Item_Codigo", Item_Codigo)
   OperadorDatos.Procedimiento = _Procedimiento
    bReturn = OperadorDatos.Ejecutar(Result)
    OperadorDatos.LimpiarParametros()
    Try
      Me.MapearDataRowaObjeto(Result.Rows(0))
      EsNuevo = False
      EsModificado = False
    Catch ex As System.Exception
      bReturn = False
    End Try
    Return bReturn
  End Function

  Public Overridable Function Guardar() As Boolean
    Dim Result As Integer = 0
    Dim bReturn As Boolean = True
    Dim sAccion As String = "M"
    If EsNuevo Then
      sAccion = "I"
    End If
    OperadorDatos.AgregarParametro("@accion", sAccion)
    OperadorDatos.AgregarParametro("@Item_Codigo", Item_Codigo)
    OperadorDatos.AgregarParametro("@Parame_TipoComponente", Parame_TipoComponente)
    OperadorDatos.AgregarParametro("@Pardet_TipoComponente", Pardet_TipoComponente)
    OperadorDatos.Procedimiento = _Procedimiento
    bReturn = OperadorDatos.Ejecutar(Result)
    OperadorDatos.LimpiarParametros()
    Return bReturn
  End Function

End Class

#End Region

#Region "CompatibilidadComponenteList"
Public Class ComponenteList
  Inherits System.ComponentModel.BindingList(Of Componente)

 
 
End Class
#End Region
