'------------------------------------------------------------------------------
' <auto-generated>
'     This code was generated by a tool.
'     Runtime Version:2.0.50727.42
'
'     Changes to this file may cause incorrect behavior and will be lost if
'     the code is regenerated.
' </auto-generated>
'------------------------------------------------------------------------------

Option Strict Off
Option Explicit On

Imports Infoware.Datos
Imports WWTS.General.Reglas
Imports Infoware.Reglas

'#Region "Beneficio"
'Public Class Beneficio
'  Inherits _Database

'  Const _Procedimiento As String = "proc_Beneficio"

'  Private mContrato As Contrato = Nothing

'  Private mBeneficioCalculado As BeneficioCalculado = Nothing

'  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _EsNuevo As Boolean)
'    MyBase.New()
'    OperadorDatos = _OperadorDatos
'    EsNuevo = _EsNuevo
'  End Sub

'  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _Contrato As Contrato, ByVal _tipo As Enumerados.enumTipoBeneficio, ByVal _sec As Integer, ByVal _Nuevo As Boolean)
'    Me.New(_OperadorDatos, False)
'    Me.Contrato = _Contrato
'    Me.Pardet_TipoBeneficioEnum = _tipo
'    Me.Benefi_Secuencia = _sec
'    If Not _Nuevo Then
'      If Not Me.Recargar Then
'        Throw New Exception("El objeto no puede ser cargado")
'      End If
'    End If
'  End Sub

'  'Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _Entida_Codigo As Integer, ByVal _Patron_Codigo As Integer, ByVal _Contra_Secuencia As Integer, ByVal _Parame_TipoBeneficio As Integer, ByVal _Pardet_TipoBeneficio As Integer, ByVal _Benefi_Secuencia As Integer)
'  '  Me.New(_OperadorDatos, False)
'  '  Entida_Codigo = _Entida_Codigo
'  '  Patron_Codigo = _Patron_Codigo
'  '  Contra_Secuencia = _Contra_Secuencia
'  '  Parame_TipoBeneficio = _Parame_TipoBeneficio
'  '  Pardet_TipoBeneficio = _Pardet_TipoBeneficio
'  '  Benefi_Secuencia = _Benefi_Secuencia
'  '  If Me.Recargar Then
'  '  Else
'  '    Throw New System.Exception("No se puede cargar objeto Beneficio")
'  '  End If
'  'End Sub

'  'Contrato
'  Public Overridable Property Contrato() As Contrato
'    Get
'      If Me.mContrato Is Nothing AndAlso Contra_Secuencia > 0 Then
'        Me.mContrato = New Contrato(OperadorDatos, Entida_Codigo, Patron_Codigo, Contra_Secuencia)
'      End If
'      Return Me.mContrato
'    End Get
'    Set(ByVal value As Contrato)
'      Me.mContrato = Value
'      Entida_Codigo = Value.Entida_Codigo
'      Patron_Codigo = Value.Patron_Codigo
'      Contra_Secuencia = Value.Contra_Secuencia
'    End Set
'  End Property

'  Public Shadows Property Pardet_TipoBeneficioEnum() As Enumerados.enumTipoBeneficio
'    Get
'      Return CType(Pardet_TipoBeneficio, Enumerados.enumTipoBeneficio)
'    End Get
'    Set(ByVal value As Enumerados.enumTipoBeneficio)
'      Pardet_TipoBeneficio = CInt(value)
'    End Set
'  End Property

'  Public Property BeneficioCalculado() As BeneficioCalculado
'    Get
'      If mBeneficioCalculado Is Nothing Then
'        mBeneficioCalculado = New BeneficioCalculado(Me.OperadorDatos, Me.Contrato, Me.Pardet_TipoBeneficio)
'      End If
'      Return mBeneficioCalculado
'    End Get
'    Set(ByVal value As BeneficioCalculado)
'      mBeneficioCalculado = value
'    End Set
'  End Property

'  Public Overridable Sub MapearDataRowaObjeto(ByVal Fila As DataRow)
'    Entida_Codigo = CType(Fila("Entida_Codigo"), Integer)
'    Patron_Codigo = CType(Fila("Patron_Codigo"), Integer)
'    Contra_Secuencia = CType(Fila("Contra_Secuencia"), Integer)
'    Parame_TipoBeneficio = CType(Fila("Parame_TipoBeneficio"), Integer)
'    Pardet_TipoBeneficio = CType(Fila("Pardet_TipoBeneficio"), Integer)
'    Benefi_Secuencia = CType(Fila("Benefi_Secuencia"), Integer)
'    Benefi_Valor = CType(Fila("Benefi_Valor"), Decimal)
'    Benefi_ValorCargas = CType(Fila("Benefi_ValorCargas"), Decimal)
'    Benefi_ValorBono = CType(Fila("Benefi_ValorBono"), Decimal)
'    Benefi_ValorBonoCargas = CType(Fila("Benefi_ValorBonoCargas"), Decimal)
'    Benefi_FechaDesde = CType(Fila("Benefi_FechaDesde"), Date)
'    Benefi_FechaHasta = CType(Fila("Benefi_FechaHasta"), Date)
'    Benefi_DiasVac = CType(Fila("Benefi_DiasVac"), Integer)
'    Benefi_DiasTrab = CType(Fila("Benefi_DiasTrab"), Integer)
'    Benefi_DiasCalc = CType(Fila("Benefi_DiasCalc"), Integer)
'    mContrato = Nothing
'  End Sub

'  Public Overridable Function Recargar() As Boolean
'    Dim Result As New DataTable
'    Dim bReturn As Boolean = True
'    OperadorDatos.AgregarParametro("@accion", "C")
'    OperadorDatos.AgregarParametro("@Entida_Codigo", Entida_Codigo)
'    OperadorDatos.AgregarParametro("@Patron_Codigo", Patron_Codigo)
'    OperadorDatos.AgregarParametro("@Contra_Secuencia", Contra_Secuencia)
'    OperadorDatos.AgregarParametro("@Parame_TipoBeneficio", Parame_TipoBeneficio)
'    OperadorDatos.AgregarParametro("@Pardet_TipoBeneficio", Pardet_TipoBeneficio)
'    OperadorDatos.AgregarParametro("@Benefi_Secuencia", Benefi_Secuencia)
'    OperadorDatos.Procedimiento = _Procedimiento
'    bReturn = OperadorDatos.Ejecutar(Result)
'    OperadorDatos.LimpiarParametros()
'    Try
'      Me.MapearDataRowaObjeto(Result.Rows(0))
'      EsNuevo = False
'      EsModificado = False
'    Catch ex As System.Exception
'      bReturn = False
'    End Try
'    Return bReturn
'  End Function

'  Public Overridable Function Guardar(ByVal _fechacorte As Date, Optional ByVal _aniodesde As Integer = 0, Optional ByVal _mesdesde As Integer = 0, Optional ByVal _aniohasta As Integer = 0, Optional ByVal _meshasta As Integer = 0) As Boolean
'    Dim Result As Integer = 0
'    Dim bReturn As Boolean = True
'    Dim sAccion As String = "M"
'    If EsNuevo Then
'      sAccion = "I"
'    End If
'    OperadorDatos.AgregarParametro("@accion", sAccion)
'    OperadorDatos.AgregarParametro("@Entida_Codigo", Entida_Codigo)
'    OperadorDatos.AgregarParametro("@Patron_Codigo", Patron_Codigo)
'    OperadorDatos.AgregarParametro("@Contra_Secuencia", Contra_Secuencia)
'    OperadorDatos.AgregarParametro("@Parame_TipoBeneficio", Parame_TipoBeneficio)
'    OperadorDatos.AgregarParametro("@Pardet_TipoBeneficio", Pardet_TipoBeneficio)
'    OperadorDatos.AgregarParametro("@Benefi_Secuencia", Benefi_Secuencia)
'    OperadorDatos.AgregarParametro("@Benefi_Valor", Benefi_Valor)
'    OperadorDatos.AgregarParametro("@Benefi_ValorCargas", Benefi_ValorCargas)
'    OperadorDatos.AgregarParametro("@Benefi_ValorBono", Benefi_ValorBono)
'    OperadorDatos.AgregarParametro("@Benefi_ValorBonoCargas", Benefi_ValorBonoCargas)
'    OperadorDatos.AgregarParametro("@Benefi_FechaDesde", Benefi_FechaDesde)
'    OperadorDatos.AgregarParametro("@Benefi_FechaHasta", Benefi_FechaHasta)
'    OperadorDatos.AgregarParametro("@Benefi_DiasVac", Benefi_DiasVac)
'    OperadorDatos.AgregarParametro("@Benefi_DiasTrab", Benefi_DiasTrab)
'    OperadorDatos.AgregarParametro("@Benefi_DiasCalc", Benefi_DiasCalc)
'    If Not (_aniohasta = 0 Or _meshasta = 0) Then
'      If Not (_aniodesde = 0 Or _mesdesde = 0) Then
'        OperadorDatos.AgregarParametro("@cortado", 1)
'        OperadorDatos.AgregarParametro("@aniodesde", _aniodesde)
'        OperadorDatos.AgregarParametro("@mesdesde", _mesdesde)
'      Else
'        OperadorDatos.AgregarParametro("@cortado", 2)
'      End If
'      OperadorDatos.AgregarParametro("@aniohasta", _aniohasta)
'      OperadorDatos.AgregarParametro("@meshasta", _meshasta)
'    End If
'    OperadorDatos.Procedimiento = _Procedimiento
'    bReturn = OperadorDatos.Ejecutar(Result)
'    OperadorDatos.LimpiarParametros()
'    If bReturn Then
'      EsNuevo = False
'      EsModificado = False
'    End If
'    Return bReturn
'  End Function

'  Public Overridable Function Eliminar() As Boolean
'    Dim bReturn As Boolean = True
'    OperadorDatos.AgregarParametro("@accion", "E")
'    OperadorDatos.AgregarParametro("@Entida_Codigo", Entida_Codigo)
'    OperadorDatos.AgregarParametro("@Patron_Codigo", Patron_Codigo)
'    OperadorDatos.AgregarParametro("@Contra_Secuencia", Contra_Secuencia)
'    OperadorDatos.AgregarParametro("@Parame_TipoBeneficio", Parame_TipoBeneficio)
'    OperadorDatos.AgregarParametro("@Pardet_TipoBeneficio", Pardet_TipoBeneficio)
'    OperadorDatos.AgregarParametro("@Benefi_Secuencia", Benefi_Secuencia)
'    OperadorDatos.Procedimiento = _Procedimiento
'    bReturn = OperadorDatos.Ejecutar
'    OperadorDatos.LimpiarParametros()
'    Return bReturn
'  End Function
'End Class
'#End Region

'#Region "BeneficioList"
'Public Class BeneficioList
'    Inherits System.ComponentModel.BindingList(Of Beneficio)

'    Public Shared Function ObtenerLista(ByVal _OperadorDatos As OperadorDatos, Optional ByVal _filtro As String = "") As BeneficioList
'        Dim oResult As BeneficioList = New BeneficioList
'        Dim bReturn As Boolean
'    Dim ds As DataTable = Nothing
'        With _OperadorDatos
'            .AgregarParametro("@Accion", "F")
'            .AgregarParametro("@filtro", _filtro)
'            .Procedimiento = "proc_Beneficio"
'            bReturn = .Ejecutar(ds)
'            .LimpiarParametros()
'        End With
'    If bReturn AndAlso ds IsNot Nothing AndAlso ds.Rows.Count > 0 Then
'      For Each _dr As DataRow In ds.Rows
'        Dim _fila As New Beneficio(_OperadorDatos, False)
'        _fila.MapearDataRowaObjeto(_dr)
'        oResult.Add(_fila)
'      Next
'    End If
'        Return oResult
'    End Function

'    Public Sub New()
'    End Sub
'End Class
'#End Region


Public Class BeneficioCalculado
  Inherits _Database

#Region "Campos constantes"
  Private Const _Procedimiento As String = "proc_beneficio"
#End Region
#Region "Campos variables"
  Private mContrato As Contrato = Nothing
  Private mTipoBeneficio As Enumerados.enumTipoBeneficio = Enumerados.enumTipoBeneficio.DecimoTercero
  Private mDiasTrabEmpresa As Double = 0
  Private mDiasAcumulados As Double = 0
  Private mDiasVacaciones As Double = 0
  Private mSueldosAcumulados As Decimal = 0
  Private mIESSAcumulados As Decimal = 0
  Private mFecDesde As DateTime = Now.Date
  Private mFecHasta As DateTime = Now.Date
  Private mUtilidadCalculada As Decimal = 0
  Private mUtilidadCargas As Decimal = 0
  Private mUtilidadBono As Decimal = 0
  Private mUtilidadBonoCargas As Decimal = 0

  Public Property Contrato() As Contrato
    Get
      Return mContrato
    End Get
    Set(ByVal Value As Contrato)
      If Value Is Nothing Then
        Throw New ArgumentNullException("No se pudo enlazar Contrato")
      End If
      Me.mContrato = Value
    End Set
  End Property
  Public Property TipoBeneficioEnum() As Enumerados.enumTipoBeneficio
    Get
      Return CType(mTipoBeneficio, Enumerados.enumTipoBeneficio)
    End Get
    Set(ByVal Value As Enumerados.enumTipoBeneficio)
      mTipoBeneficio = CInt(Value)
    End Set
  End Property
  Public ReadOnly Property DecimoCalculado() As Decimal
    Get
      Select Case mTipoBeneficio
        Case Enumerados.enumTipoBeneficio.DecimoCuarto
          Dim config As ConfigRoles
          config = New ConfigRoles(Me.OperadorDatos, mContrato.Patrono.PardetParroquia.PardetPadre.PardetPadre.PardetPadre, False)
          Return config.Cnfrol_salariomv / 360 * DiasAcumulados
        Case Enumerados.enumTipoBeneficio.DecimoTercero
          Return SueldosAcumulados / 12
        Case Enumerados.enumTipoBeneficio.Vacaciones
          Return SueldosAcumulados / 12 / 2
      End Select
    End Get
  End Property
  Public Property DiasAcumulados() As Double
    Get
      Return IIf(mDiasAcumulados >= 359 And mDiasAcumulados <= 365, 360, mDiasAcumulados)
    End Get
    Set(ByVal Value As Double)
      mDiasAcumulados = Value
    End Set
  End Property
  Public Property DiasTrabEmpresa() As Double
    Get
      Return mDiasTrabEmpresa
    End Get
    Set(ByVal Value As Double)
      mDiasTrabEmpresa = Value
    End Set
  End Property
  Public Property DiasVacaciones() As Double
    Get
      If mDiasVacaciones = 0 Then
        Dim anios As Integer = Int(DiasTrabEmpresa / 365)
        mDiasVacaciones = 14 + IIf(anios <= 3, 0, anios - 3)
      End If
      Return mDiasVacaciones
    End Get
    Set(ByVal Value As Double)
      mDiasVacaciones = Value
    End Set
  End Property
  Public Property SueldosAcumulados() As Decimal
    Get
      Return mSueldosAcumulados
    End Get
    Set(ByVal Value As Decimal)
      mSueldosAcumulados = Value
    End Set
  End Property
  Public Property IESSAcumulados() As Decimal
    Get
      Return mIESSAcumulados
    End Get
    Set(ByVal Value As Decimal)
      mIESSAcumulados = Value
    End Set
  End Property
  Public Property FecDesde() As DateTime
    Get
      Return mFecDesde
    End Get
    Set(ByVal Value As DateTime)
      mFecDesde = Value
    End Set
  End Property
  Public Property FecHasta() As DateTime
    Get
      Return mFecHasta
    End Get
    Set(ByVal Value As DateTime)
      mFecHasta = Value
    End Set
  End Property
  Public Property UtilidadCalculada() As Decimal
    Get
      Return mUtilidadCalculada
    End Get
    Set(ByVal value As Decimal)
      mUtilidadCalculada = value
    End Set
  End Property
  Public Property UtilidadCargas() As Decimal
    Get
      Return mUtilidadCargas
    End Get
    Set(ByVal value As Decimal)
      mUtilidadCargas = value
    End Set
  End Property
  Public Property UtilidadBono() As Decimal
    Get
      Return mUtilidadBono
    End Get
    Set(ByVal value As Decimal)
      mUtilidadBono = value
    End Set
  End Property
  Public Property UtilidadBonoCargas() As Decimal
    Get
      Return mUtilidadBonoCargas
    End Get
    Set(ByVal value As Decimal)
      mUtilidadBonoCargas = value
    End Set
  End Property
#End Region
#Region "Constructores"
  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _Contrato As Contrato, ByVal _TipoBeneficio As Enumerados.enumTipoBeneficio)
    If _OperadorDatos Is Nothing Then
      Throw New InvalidOperationException("El Operador de datos es nulo")
    End If
    OperadorDatos = _OperadorDatos
    Contrato = _Contrato
    TipoBeneficioEnum = _TipoBeneficio
    If Not Recargar() Then
      'Throw New Exception("El objeto no puede ser cargado")
    End If
  End Sub
  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _Contrato As Contrato, ByVal _TipoBeneficio As Enumerados.enumTipoBeneficio, ByVal _cortadoalanio As Integer, ByVal _cortadoalmes As Integer)
    If _OperadorDatos Is Nothing Then
      Throw New InvalidOperationException("El Operador de datos es nulo")
    End If
    OperadorDatos = _OperadorDatos
    Contrato = _Contrato
    TipoBeneficioEnum = _TipoBeneficio
    If Not Recargar(_cortadoalanio, _cortadoalmes) Then
      'Throw New Exception("El objeto no puede ser cargado")
    End If
  End Sub
  Public Sub New(ByVal _OperadorDatos As OperadorDatos, ByVal _Contrato As Contrato, ByVal _TipoBeneficio As Enumerados.enumTipoBeneficio, ByVal _desdeanio As Integer, ByVal _desdemes As Integer, ByVal _hastaanio As Integer, ByVal _hastames As Integer)
    If _OperadorDatos Is Nothing Then
      Throw New InvalidOperationException("El Operador de datos es nulo")
    End If
    OperadorDatos = _OperadorDatos
    Contrato = _Contrato
    TipoBeneficioEnum = _TipoBeneficio
    If Not Recargar(_desdeanio, _desdemes, _hastaanio, _hastames) Then
      'Throw New Exception("El objeto no puede ser cargado")
    End If
  End Sub
#End Region
#Region "Implementación de los métodos de persistencia"
  Public Function Recargar() As Boolean
    Dim dsResult As New DataTable
    Dim bResult As Boolean

    With Me.OperadorDatos
      .AgregarParametro("@accion", "d")
      .AgregarParametro("@Contra_Secuencia", Contrato.Contra_Secuencia)
      .AgregarParametro("@Entida_Codigo", Contrato.Entida_Codigo)
      .AgregarParametro("@Patron_codigo", Contrato.Patron_Codigo)
      .AgregarParametro("@Pardet_Tipobeneficio", Me.TipoBeneficioEnum)
      .Procedimiento = _Procedimiento
      bResult = .Ejecutar(dsResult)
      .LimpiarParametros()
    End With
    If bResult AndAlso dsResult IsNot Nothing AndAlso dsResult.Rows.Count > 0 Then
      Me.MapearDataRowaObjeto(dsResult.Rows(0))
      Return True
    Else
      Return False
    End If
  End Function
  Public Function Recargar(ByVal _cortadoalanio As Integer, ByVal _cortadoalmes As Integer) As Boolean
    Dim dsResult As New DataTable
    Dim bResult As Boolean

    With Me.OperadorDatos
      .AgregarParametro("@accion", "d")
      .AgregarParametro("@Contra_Secuencia", Contrato.Contra_Secuencia)
      .AgregarParametro("@Entida_Codigo", Contrato.Entida_Codigo)
      .AgregarParametro("@Patron_codigo", Contrato.Patron_Codigo)
      .AgregarParametro("@Pardet_TipoBeneficio", Me.TipoBeneficioEnum)
      .AgregarParametro("@cortado", 2)
      .AgregarParametro("@aniohasta", _cortadoalanio)
      .AgregarParametro("@meshasta", _cortadoalmes)
      .Procedimiento = _Procedimiento
      bResult = .Ejecutar(dsResult)
      .LimpiarParametros()
    End With
    If bResult AndAlso dsResult IsNot Nothing AndAlso dsResult.Rows.Count > 0 Then
      Me.MapearDataRowaObjeto(dsResult.Rows(0))
      Return True
    Else
      Return False
    End If
  End Function
  Public Function Recargar(ByVal _desdeanio As Integer, ByVal _desdemes As Integer, ByVal _hastaanio As Integer, ByVal _hastames As Integer) As Boolean
    Dim dsResult As New DataTable
    Dim bResult As Boolean

    With Me.OperadorDatos
      .AgregarParametro("@accion", "d")
      .AgregarParametro("@Contra_Secuencia", Contrato.Contra_Secuencia)
      .AgregarParametro("@Entida_Codigo", Contrato.Entida_Codigo)
      .AgregarParametro("@Patron_codigo", Contrato.Patron_Codigo)
      .AgregarParametro("@Pardet_TipoBeneficio", Me.TipoBeneficioEnum)
      .AgregarParametro("@cortado", 1)
      .AgregarParametro("@aniodesde", _desdeanio)
      .AgregarParametro("@mesdesde", _desdemes)
      .AgregarParametro("@aniohasta", _hastaanio)
      .AgregarParametro("@meshasta", _hastames)
      .Procedimiento = _Procedimiento
      bResult = .Ejecutar(dsResult)
      .LimpiarParametros()
    End With
    If bResult AndAlso dsResult IsNot Nothing AndAlso dsResult.Rows.Count > 0 Then
      Me.MapearDataRowaObjeto(dsResult.Rows(0))
      Return True
    Else
      Return False
    End If
  End Function
#End Region
#Region "Métodos internos de la clase"
  Private Sub MapearDataRowaObjeto(ByVal Fila As DataRow)
    Select Case mTipoBeneficio
      Case Enumerados.enumTipoBeneficio.DecimoTercero
        Me.mDiasAcumulados = CInt(Fila("diasd3"))
        Me.mSueldosAcumulados = CDec(Fila("d3"))
        Me.mIESSAcumulados = CDec(Fila("iessd3"))
        Dim desde As Long = CStr(Fila("desde"))
        Me.mFecDesde = New DateTime(Int(desde / 100), desde Mod 100, 1)
        Dim hasta As Long = CStr(Fila("hasta"))
        Me.mFecHasta = New DateTime(Int(hasta / 100), hasta Mod 100, 25).AddDays(7)
        Me.mFecHasta = mFecHasta.AddDays(-mFecHasta.Day + 1)
      Case Enumerados.enumTipoBeneficio.DecimoCuarto
        Me.mDiasAcumulados = CInt(Fila("diasd4"))
        Me.mSueldosAcumulados = CDec(Fila("d4"))
        Me.mIESSAcumulados = CDec(Fila("iessd4"))
        Dim desde As Long = CStr(Fila("desde"))
        Me.mFecDesde = New DateTime(Int(desde / 100), desde Mod 100, 1)
        Dim hasta As Long = CStr(Fila("hasta"))
        Me.mFecHasta = New DateTime(Int(hasta / 100), hasta Mod 100, 25).AddDays(7)
        Me.mFecHasta = mFecHasta.AddDays(-mFecHasta.Day + 1)
      Case Enumerados.enumTipoBeneficio.Vacaciones
        Me.mDiasTrabEmpresa = CInt(Fila("DiasTrabEmpresa"))
        Me.mDiasAcumulados = CInt(Fila("diasvac"))
        Me.mSueldosAcumulados = CDec(Fila("vac"))
        Me.mIESSAcumulados = CDec(Fila("iessvac"))
        Dim desde As Long = CStr(Fila("desde"))
        Me.mFecDesde = New DateTime(Int(desde / 100), desde Mod 100, 1)
        Dim hasta As Long = CStr(Fila("hasta"))
        Me.mFecHasta = New DateTime(Int(hasta / 100), hasta Mod 100, 25).AddDays(7)
        Me.mFecHasta = mFecHasta.AddDays(-mFecHasta.Day + 1)
      Case Enumerados.enumTipoBeneficio.Utilidades
        Me.mDiasTrabEmpresa = CInt(Fila("DiasTrabEmpresa"))
        Me.mDiasAcumulados = CInt(Fila("diasuti"))
        Me.mSueldosAcumulados = CDec(Fila("uti"))
        Me.mIESSAcumulados = CDec(Fila("iessuti"))
        Dim desde As Long = CStr(Fila("desde"))
        Me.mFecDesde = New DateTime(Int(desde / 100), desde Mod 100, 1)
        Dim hasta As Long = CStr(Fila("hasta"))
        Me.mFecHasta = New DateTime(Int(hasta / 100), hasta Mod 100, 25).AddDays(7)
        Me.mFecHasta = mFecHasta.AddDays(-mFecHasta.Day + 1)
    End Select
  End Sub
#End Region
End Class
